# Cluster Analysis

```{r}
source(here::here("R", "caFunction.R"))
```

This chapter focuses on **clustering analysis**, with the aim of identifying pattern in the data. The adopted approach is structured into multiple stages, each designed to evaluate, through different methods, the feasibility and robustness of clustering.

## Feasibility of the cluster analysis 

This first part investigates the **feasibility of clustering** by means of several exploratory techniques. Specifically, scatter plots of the variables colored according to the binary variable Private are compared with scatter plots generated from random values, in order to assess the presence of non-random patterns. The analysis is then extended to the first two principal components obtained via PCA. To further explore the correlation structure among observations, the *VAT (Visual Assessment of Tendency)* algorithm is applied, and the *Hopkins* statistic is computed to measure the clustering tendency of the dataset.

```{r}
random_df <- as.data.frame(apply(num_data, 2, function(x){
  runif(length(x), min(x), max(x))
}))

df <- scale(num_data)
random_df <- scale(random_df)
```


<div class="hscroll-plot">
<div class='plot-container'>
```{r}
jco_colors <- get_palette("jco", 2)

colors <- ifelse(College$Private == "Yes", jco_colors[1], jco_colors[2])

pairs(df, gap=0, pch=16, cex=0.4, col = colors)
```
</div>

<div class='plot-container'>
```{r}
pairs(random_df, gap=0, pch=16, cex=0.4)
```
</div>
</div>

<div class="hscroll-plot">
<div class='plot-container'>
```{r}
fviz_pca_ind(pca, title="PCA - College data", habillage=College$Private, palette="jco", geom="point", ggtheme=theme_classic(), legend="bottom")
```
</div>
<div class='plot-container'>
```{r}
fviz_pca_ind(prcomp(random_df), title="PCA - Random data", geom="point", ggtheme=theme_classic())
```
</div>
</div>

<div class="hscroll-plot">
<div class='plot-container'>
```{r}
fviz_dist(dist(df), show_labels=FALSE) + labs(title="College data")
```
</div>
<div class='plot-container'>
```{r}
fviz_dist(dist(random_df), show_labels=FALSE) + labs(title="College data")
```
</div>
</div>

```{r warning=FALSE}
set.seed(123)
hopkinsValue <- clustertend::hopkins(df, n=nrow(df)-1)
```

Both the **VAT algorithm** and the **Hopkins statistic** (`r hopkinsValue`) indicate the presence of clusters in the dataset.

## Hard clustering

This part is devoted to the application of hard clustering algorithms. 

```{r child="Rmd/clusterAnalysis/hierarchicalClustering.Rmd"}
```

```{r child="Rmd/clusterAnalysis/partitionalClustering.Rmd"}
```

```{r child="Rmd/clusterAnalysis/densityBasedClustering.Rmd"}
```

```{r child="Rmd/clusterAnalysis/clValidation.Rmd"}
```

## Soft Clustering

This section is devoted to the application of soft clustering approaches, such as **fuzzy clustering** and **model-based clustering**.

```{r child="Rmd/clusterAnalysis/fuzzyClustering.Rmd"}
```

<!-- ## Probabilistic assumptions -->

```{r child="Rmd/clusterAnalysis/modelBasedClustering.Rmd"}
```
